---
title: 计算机网络-物理层和链路层
date: 2025-02-06 22:32:13
tags: 计算机网络
---

# 计算机网络 - 物理层

## 通信方式



根据信息在传输线上的传送方向，分为以下三种通信方式：

- 单工通信：单向传输
- 半双工通信：双向交替传输
- 全双工通信：双向同时传输

## 带通调制



模拟信号是连续的信号，数字信号是离散的信号。带通调制把数字信号转换为模拟信号。

[![img](https://camo.githubusercontent.com/b0a3e9797d5d9a6c11e4429f20eddba4572c5bb1c2b18629bc28bad36da25faa/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f63333466343530332d663632632d343034332d396463362d3365303332383836353764662e6a7067)](https://camo.githubusercontent.com/b0a3e9797d5d9a6c11e4429f20eddba4572c5bb1c2b18629bc28bad36da25faa/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f63333466343530332d663632632d343034332d396463362d3365303332383836353764662e6a7067)

# 计算机网络 - 链路层

## 基本问题



### 1. 封装成帧



将网络层传下来的分组添加首部和尾部，用于标记帧的开始和结束。

[![img](https://camo.githubusercontent.com/236306f60649d3387b91f8d9f2d56a3f6350b1eb9e499baacc46d8bb72b591e7/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32396131343733352d653135342d346636302d396130342d6339363238653564303966342e706e67)](https://camo.githubusercontent.com/236306f60649d3387b91f8d9f2d56a3f6350b1eb9e499baacc46d8bb72b591e7/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32396131343733352d653135342d346636302d396130342d6339363238653564303966342e706e67)

### 2. 透明传输



透明表示一个实际存在的事物看起来好像不存在一样。

帧使用首部和尾部进行定界，如果帧的数据部分含有和首部尾部相同的内容，那么帧的开始和结束位置就会被错误的判定。需要在数据部分出现首部尾部相同的内容前面插入转义字符。如果数据部分出现转义字符，那么就在转义字符前面再加个转义字符。在接收端进行处理之后可以还原出原始数据。这个过程透明传输的内容是转义字符，用户察觉不到转义字符的存在。

[![img](https://camo.githubusercontent.com/f7a12ff9b3506ca6085f0ebba380eefefdddfa5f542219ec1f7c253ed38121d0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65373338613364322d663432652d343735352d616531332d6361323334393765376139372e706e67)](https://camo.githubusercontent.com/f7a12ff9b3506ca6085f0ebba380eefefdddfa5f542219ec1f7c253ed38121d0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65373338613364322d663432652d343735352d616531332d6361323334393765376139372e706e67)

### 3. 差错检测



目前数据链路层广泛使用了循环冗余检验（CRC）来检查比特差错。

## 信道分类



### 1. 广播信道



一对多通信，一个节点发送的数据能够被广播信道上所有的节点接收到。

所有的节点都在同一个广播信道上发送数据，因此需要有专门的控制方法进行协调，避免发生冲突（冲突也叫碰撞）。

主要有两种控制方法进行协调，一个是使用信道复用技术，一是使用 CSMA/CD 协议。

### 2. 点对点信道



一对一通信。

因为不会发生碰撞，因此也比较简单，使用 PPP 协议进行控制。

## 信道复用技术



### 1. 频分复用



频分复用的所有主机在相同的时间占用不同的频率带宽资源。

[![img](https://camo.githubusercontent.com/dfcf1d74b35325b3bd095287032b8448e3566108c96f6a8956c87a111373418f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f34616135653035372d626335372d343731392d616235372d6336666263383631633530352e706e67)](https://camo.githubusercontent.com/dfcf1d74b35325b3bd095287032b8448e3566108c96f6a8956c87a111373418f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f34616135653035372d626335372d343731392d616235372d6336666263383631633530352e706e67)

### 2. 时分复用



时分复用的所有主机在不同的时间占用相同的频率带宽资源。

[![img](https://camo.githubusercontent.com/11f13cce210b04052b15df8e3dbe8e504518b6ea44a0a4df3e5127846400e3b3/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373538326164652d643434612d343661362d383735372d3363313239366363316566392e706e67)](https://camo.githubusercontent.com/11f13cce210b04052b15df8e3dbe8e504518b6ea44a0a4df3e5127846400e3b3/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373538326164652d643434612d343661362d383735372d3363313239366363316566392e706e67)

使用频分复用和时分复用进行通信，在通信的过程中主机会一直占用一部分信道资源。但是由于计算机数据的突发性质，通信过程没必要一直占用信道资源而不让出给其它用户使用，因此这两种方式对信道的利用率都不高。

### 3. 统计时分复用



是对时分复用的一种改进，不固定每个用户在时分复用帧中的位置，只要有数据就集中起来组成统计时分复用帧然后发送。

[![img](https://camo.githubusercontent.com/1dcc7e015c983c524f403b506555741aa129bc79678c5b434ce776caa0dde13f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36323833626532612d383134612d346131302d383462662d3935393235333366653662632e706e67)](https://camo.githubusercontent.com/1dcc7e015c983c524f403b506555741aa129bc79678c5b434ce776caa0dde13f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36323833626532612d383134612d346131302d383462662d3935393235333366653662632e706e67)

### 4. 波分复用



光的频分复用。由于光的频率很高，因此习惯上用波长而不是频率来表示所使用的光载波。

### 5. 码分复用



为每个用户分配 m bit 的码片，并且所有的码片正交，对于任意两个码片 [![img](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d)](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d) 和 [![img](https://camo.githubusercontent.com/c3f453d490a4e3b68eee767414ca292dafce723a8606c44406a6f89dbb65bd37/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b547d)](https://camo.githubusercontent.com/c3f453d490a4e3b68eee767414ca292dafce723a8606c44406a6f89dbb65bd37/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b547d) 有

[![img](https://camo.githubusercontent.com/cca7a3e90f5b74cdb7f9657161055e076ec64177f2e37ee648fd7dc6e8dbaac3/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f33303861303265392d333334362d343235312d386334312d6264353533366461623439312e706e67)](https://camo.githubusercontent.com/cca7a3e90f5b74cdb7f9657161055e076ec64177f2e37ee648fd7dc6e8dbaac3/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f33303861303265392d333334362d343235312d386334312d6264353533366461623439312e706e67)

为了讨论方便，取 m=8，设码片 [![img](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d)](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d) 为 00011011。在拥有该码片的用户发送比特 1 时就发送该码片，发送比特 0 时就发送该码片的反码 11100100。

在计算时将 00011011 记作 (-1 -1 -1 +1 +1 -1 +1 +1)，可以得到

[![img](https://camo.githubusercontent.com/485d4f33dc84e25b82985181b2de9e90433bd3fcacae119559bba39849c4668f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36666461316463372d356337342d343963312d626237392d3233376137376534336134332e706e67)](https://camo.githubusercontent.com/485d4f33dc84e25b82985181b2de9e90433bd3fcacae119559bba39849c4668f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36666461316463372d356337342d343963312d626237392d3233376137376534336134332e706e67)

[![img](https://camo.githubusercontent.com/f74616f027006afb5c12a0043956a48cf6ccfacc05c57799e56ee37cd0d9425b/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65333235613930332d663062312d346662642d383262662d3838393133646332663239302e706e67)](https://camo.githubusercontent.com/f74616f027006afb5c12a0043956a48cf6ccfacc05c57799e56ee37cd0d9425b/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65333235613930332d663062312d346662642d383262662d3838393133646332663239302e706e67)

其中 [![img](https://camo.githubusercontent.com/40844747da21364571fec31dfd190e236f99b7d93532d86d577cccc719a1b26b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b53277d)](https://camo.githubusercontent.com/40844747da21364571fec31dfd190e236f99b7d93532d86d577cccc719a1b26b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b53277d) 为 [![img](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d)](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d) 的反码。

利用上面的式子我们知道，当接收端使用码片 [![img](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d)](https://camo.githubusercontent.com/839436a7cea59ea9b05666c7ac74f797420adf2c8aae189d9ce91d3c5de129fe/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c7665637b537d) 对接收到的数据进行内积运算时，结果为 0 的是其它用户发送的数据，结果为 1 的是用户发送的比特 1，结果为 -1 的是用户发送的比特 0。

码分复用需要发送的数据量为原先的 m 倍。

[![img](https://camo.githubusercontent.com/62c29ba6714790a382b214e86b9c38e7cf674a3dee499df8e42cfb68c16dc9fd/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39396236303630652d303939642d343230312d386538362d6638616233373638613763662e706e67)](https://camo.githubusercontent.com/62c29ba6714790a382b214e86b9c38e7cf674a3dee499df8e42cfb68c16dc9fd/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39396236303630652d303939642d343230312d386538362d6638616233373638613763662e706e67)

## CSMA/CD 协议



CSMA/CD 表示载波监听多点接入 / 碰撞检测。

- **多点接入** ：说明这是总线型网络，许多主机以多点的方式连接到总线上。
- **载波监听** ：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用，就必须等待。
- **碰撞检测** ：在发送中，如果监听到信道已有其它主机正在发送数据，就表示发生了碰撞。虽然每个主机在发送数据之前都已经监听到信道为空闲，但是由于电磁波的传播时延的存在，还是有可能会发生碰撞。

记端到端的传播时延为 τ，最先发送的站点最多经过 2τ 就可以知道是否发生了碰撞，称 2τ 为 **争用期** 。只有经过争用期之后还没有检测到碰撞，才能肯定这次发送不会发生碰撞。

当发生碰撞时，站点要停止发送，等待一段时间再发送。这个时间采用 **截断二进制指数退避算法** 来确定。从离散的整数集合 {0, 1, .., (2k-1)} 中随机取出一个数，记作 r，然后取 r 倍的争用期作为重传等待时间。

[![img](https://camo.githubusercontent.com/3472ccc39932217b0513166627a37a344d53e63b8ea5424afec524b073a268d2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31396434323365392d373466372d346332622d396239372d3535383930653064353139332e706e67)](https://camo.githubusercontent.com/3472ccc39932217b0513166627a37a344d53e63b8ea5424afec524b073a268d2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31396434323365392d373466372d346332622d396239372d3535383930653064353139332e706e67)

## PPP 协议



互联网用户通常需要连接到某个 ISP 之后才能接入到互联网，PPP 协议是用户计算机和 ISP 进行通信时所使用的数据链路层协议。

[![img](https://camo.githubusercontent.com/6569a763ceb985e5df9d1a0d43a961a2595f16c28d21e7dec29a40defac2081c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65316162396632382d636231352d343137382d383462322d3938616164383766396263382e6a7067)](https://camo.githubusercontent.com/6569a763ceb985e5df9d1a0d43a961a2595f16c28d21e7dec29a40defac2081c/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65316162396632382d636231352d343137382d383462322d3938616164383766396263382e6a7067)

PPP 的帧格式：

- F 字段为帧的定界符
- A 和 C 字段暂时没有意义
- FCS 字段是使用 CRC 的检验序列
- 信息部分的长度不超过 1500

[![img](https://camo.githubusercontent.com/cbcebb9c458a5ce521e60933036f5b405453a941ef8b3bda27fe82b4c9c67dfb/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f37353930313364372d363164382d343530392d383937612d6437356166353938613233362e706e67)](https://camo.githubusercontent.com/cbcebb9c458a5ce521e60933036f5b405453a941ef8b3bda27fe82b4c9c67dfb/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f37353930313364372d363164382d343530392d383937612d6437356166353938613233362e706e67)

## MAC 地址



MAC 地址是链路层地址，长度为 6 字节（48 位），用于唯一标识网络适配器（网卡）。

一台主机拥有多少个网络适配器就有多少个 MAC 地址。例如笔记本电脑普遍存在无线网络适配器和有线网络适配器，因此就有两个 MAC 地址。

## 局域网



局域网是一种典型的广播信道，主要特点是网络为一个单位所拥有，且地理范围和站点数目均有限。

主要有以太网、令牌环网、FDDI 和 ATM 等局域网技术，目前以太网占领着有线局域网市场。

可以按照网络拓扑结构对局域网进行分类：

[![img](https://camo.githubusercontent.com/c51260b716e5dd17f9848e0eb3c498d3d3bf5f7990238f2a9ca30c04d01ea2be/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38303766343235382d646261382d346335342d396333632d6137303763376363666661322e6a7067)](https://camo.githubusercontent.com/c51260b716e5dd17f9848e0eb3c498d3d3bf5f7990238f2a9ca30c04d01ea2be/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f38303766343235382d646261382d346335342d396333632d6137303763376363666661322e6a7067)

## 以太网



以太网是一种星型拓扑结构局域网。

早期使用集线器进行连接，集线器是一种物理层设备， 作用于比特而不是帧，当一个比特到达接口时，集线器重新生成这个比特，并将其能量强度放大，从而扩大网络的传输距离，之后再将这个比特发送到其它所有接口。如果集线器同时收到两个不同接口的帧，那么就发生了碰撞。

目前以太网使用交换机替代了集线器，交换机是一种链路层设备，它不会发生碰撞，能根据 MAC 地址进行存储转发。

以太网帧格式：

- **类型** ：标记上层使用的协议；
- **数据** ：长度在 46-1500 之间，如果太小则需要填充；
- **FCS** ：帧检验序列，使用的是 CRC 检验方法；

[![img](https://camo.githubusercontent.com/01728d010c90996fac2721ee067404a0566fcd2926431228244da9fac2fb430f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31363439343464332d626264322d346262322d393234622d6536323139396335316239302e706e67)](https://camo.githubusercontent.com/01728d010c90996fac2721ee067404a0566fcd2926431228244da9fac2fb430f/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31363439343464332d626264322d346262322d393234622d6536323139396335316239302e706e67)

## 交换机



交换机具有自学习能力，学习的是交换表的内容，交换表中存储着 MAC 地址到接口的映射。

正是由于这种自学习能力，因此交换机是一种即插即用设备，不需要网络管理员手动配置交换表内容。

下图中，交换机有 4 个接口，主机 A 向主机 B 发送数据帧时，交换机把主机 A 到接口 1 的映射写入交换表中。为了发送数据帧到 B，先查交换表，此时没有主机 B 的表项，那么主机 A 就发送广播帧，主机 C 和主机 D 会丢弃该帧，主机 B 回应该帧向主机 A 发送数据包时，交换机查找交换表得到主机 A 映射的接口为 1，就发送数据帧到接口 1，同时交换机添加主机 B 到接口 2 的映射。

[![img](https://camo.githubusercontent.com/e9f67440260d26c588a09bbdade9d18f0a9f76f2dc515742cd091c08ce9959a2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f61343434343534352d306436382d343031352d396133642d3139323039646334333662332e706e67)](https://camo.githubusercontent.com/e9f67440260d26c588a09bbdade9d18f0a9f76f2dc515742cd091c08ce9959a2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f61343434343534352d306436382d343031352d396133642d3139323039646334333662332e706e67)

## 虚拟局域网



虚拟局域网可以建立与物理位置无关的逻辑组，只有在同一个虚拟局域网中的成员才会收到链路层广播信息。

例如下图中 (A1, A2, A3, A4) 属于一个虚拟局域网，A1 发送的广播会被 A2、A3、A4 收到，而其它站点收不到。

使用 VLAN 干线连接来建立虚拟局域网，每台交换机上的一个特殊接口被设置为干线接口，以互连 VLAN 交换机。IEEE 定义了一种扩展的以太网帧格式 802.1Q，它在标准以太网帧上加进了 4 字节首部 VLAN 标签，用于表示该帧属于哪一个虚拟局域网。

[![img](https://camo.githubusercontent.com/1c6690d43983123bffc643ee40fcac5a4e9b76f23b2dc2160e9b133d1cbc581a/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65393865396432302d323036622d343533332d626163662d3334343864303039366633382e706e67)](https://camo.githubusercontent.com/1c6690d43983123bffc643ee40fcac5a4e9b76f23b2dc2160e9b133d1cbc581a/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f65393865396432302d323036622d343533332d626163662d3334343864303039366633382e706e67)
